<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Suface kinetics · LiquidElectrolytes.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LiquidElectrolytes.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../api/">Electrolyte models</a></li><li><a class="tocitem" href="../../std/">Standard calculations</a></li><li><a class="tocitem" href="../../changes/">Changes</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../Example101_DLCap/">Double Layer Capacitance</a></li><li><a class="tocitem" href="../Example110_Fe23Cell/">Fe redox half cell</a></li><li class="is-active"><a class="tocitem" href>Suface kinetics</a></li><li><a class="tocitem" href="../Example120_ORRCell/">ORR Half cell</a></li></ul></li><li><a class="tocitem" href="../../internal/">Internal API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Suface kinetics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Suface kinetics</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/j-fu/LiquidElectrolytes.jl/blob/main/examples/Example111_SurfaceKinetics.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Suface-kinetics"><a class="docs-heading-anchor" href="#Suface-kinetics">Suface kinetics</a><a id="Suface-kinetics-1"></a><a class="docs-heading-anchor-permalink" href="#Suface-kinetics" title="Permalink"></a></h1><p>(<a href="https://github.com/j-fu/LiquidElectrolytes.jl/blob/main/examples/Example111_SurfaceKinetics.jl">source code</a>)</p><pre><code class="language-julia hljs">module Example111_SurfaceKinetics
using LessUnitful
using ExtendableGrids, GridVisualize
using VoronoiFVM
using LiquidElectrolytes
using Colors
using StaticArrays
using InteractiveUtils
using ForwardDiff


function main(;
    nref = 0,
    voltages = (-3.0:0.1:3.0) * ufac&quot;V&quot;,
    molarities = [0.001, 0.01, 0.1, 1],
    scheme = :μex,
    κ = 10.0,
    Plotter = nothing,
    new = false,
    kwargs...,
)

    @local_phconstants N_A e R ε_0 k_B
    F = N_A * e
    c_0 = 2.99792458e8
    @local_unitfactors cm μF mol dm s mA A nm bar eV μA



    defaults = (;
        max_round = 3,
        tol_round = 1.0e-9,
        verbose = &quot;e&quot;,
        reltol = 1.0e-8,
        tol_mono = 1.0e-10,
    )

    kwargs = merge(defaults, kwargs)

    hmin = 1.0e-1 * ufac&quot;μm&quot; * 2.0^(-nref)
    hmax = 1.0 * ufac&quot;μm&quot; * 2.0^(-nref)
    L = 80.0 * ufac&quot;μm&quot;
    X = geomspace(0, L, hmin, hmax)
    grid = simplexgrid(X)

    T = 273.15 + 25 * ufac&quot;K&quot;


    # kinetic model
    # A+_aq &lt;-&gt; A+_ads,	                    ##1
    # A+_ads + e- &lt;-&gt; A_ads,                ##2
    # A_ads &lt;-&gt; A_aq                        ##3


    bulk_species = [&quot;A+_aq&quot;, &quot;A_aq&quot;]
    surface_species = [&quot;A+_ads&quot;, &quot;A_ads&quot;]

    C_gap = 20 * ufac&quot;μF/cm^2&quot;
    ϕ_pzc = 0.2 * ufac&quot;V&quot;

    iaplus = 1
    ibminus = 2
    ia = 3
    iaplus_ads = 4
    ia_ads = 5


    function halfcellbc(
        f,
        u::VoronoiFVM.BNodeUnknowns{Tval,Tv,Tc,Tp,Ti},
        bnode,
        data,
    ) where {Tval,Tv,Tc,Tp,Ti}
        (; nc, na, Γ_we, Γ_bulk, ϕ_we, ip, iϕ, v, v0, T, RT, ε) = data

        bulkbcondition(f, u, bnode, data; region = Γ_bulk)


        if bnode.region == Γ_we

            # boundary_dirichlet!(f,u,bnode;species=iϕ,region=Γ_we,value=ϕ_we)

            # Robin b.c. for the Poisson equation

            boundary_robin!(f, u, bnode, iϕ, C_gap / ε, C_gap * (ϕ_we - ϕ_pzc) / ε)

            # surface current density
            sigma = C_gap * (ϕ_we - u[iϕ] - ϕ_pzc)

            kf = zeros(Tval, 3)
            kr = zeros(Tval, 3)

            # A+_aq &lt;-&gt; A+_ads,	                    ##1
            ΔG_ads_aplus = 1.0 * eV + 1.0e+1 * sigma * eV

            kf[1] = 1.0e13 * exp(-max(ΔG_ads_aplus, 0.0) / (k_B * T))
            kr[1] = 1.0e13 * exp(-max(-ΔG_ads_aplus, 0.0) / (k_B * T))

            # A+_ads + e- &lt;-&gt; A_ads,                ##2
            ΔG_rxn = 1.0 * eV + 1.5e+1 * sigma * eV

            kf[2] = 1.0e13 * exp(-max(ΔG_rxn, 0.0) / (k_B * T))
            kr[2] = 1.0e13 * exp(-max(-ΔG_rxn, 0.0) / (k_B * T))

            # A_ads &lt;-&gt; A_aq                        ##3
            ΔG_ads_a = 0.5 * eV + 0.5e+1 * sigma * eV

            kf[3] = 1.0e13 * exp(-max(ΔG_ads_a, 0.0) / (k_B * T))
            kr[3] = 1.0e13 * exp(-max(-ΔG_ads_a, 0.0) / (k_B * T))

            S = 1.0e-6 / N_A * (1.0e10)^2 * ufac&quot;mol/m^2&quot;
            θ_free = 1 - u[iaplus_ads] - u[ia_ads]

            rates = zeros(Tval, 3)

            rates[1] = kf[1] * u[iaplus] * θ_free - kr[1] * u[iaplus_ads]
            rates[2] = kf[2] * u[iaplus_ads] - kr[2] * u[ia_ads]
            rates[3] = kf[3] * u[ia_ads] - kr[3] * u[ia] * θ_free

            println(
                &quot;rate constants: $(ForwardDiff.value.(kf)) and $(ForwardDiff.value.(kr))&quot;,
            )
            println(&quot;rates: $(ForwardDiff.value.(rates))&quot;)
            println(&quot;aplus: $(ForwardDiff.value(u[iaplus]))&quot;)

            # bulk species
            f[iaplus] += -rates[1] * S
            f[ia] += rates[3] * S

            # surface species
            f[iaplus_ads] += rates[1] - rates[2]
            f[ia_ads] += rates[2] - rates[3]

        end
        nothing
    end


    celldata = ElectrolyteData(;
        nc = 3,
        na = 2,
        z = [1, -1, 0],
        D = [2.0e-9, 2.0e-9, 2.0e-9] * ufac&quot;m^2/s&quot;, ## from Ringe paper
        T = T,
        eneutral = false,
        κ = fill(κ, 3),
        Γ_we = 1,
        Γ_bulk = 2,
        scheme,
    )

    (; iϕ::Int, ip::Int) = celldata

    celldata.c_bulk[iaplus] = 0.1 * mol / dm^3
    celldata.c_bulk[ibminus] = 0.1 * mol / dm^3
    celldata.c_bulk[ia] = 0.1 * mol / dm^3

    @assert isapprox(celldata.c_bulk&#39; * celldata.z, 0, atol = 1.0e-10)

    cell = PNPSystem(grid; bcondition = halfcellbc, celldata)

    un = unknowns(cell)
    @views un[iaplus_ads, :] .= 0.1
    @views un[ia_ads, :] .= 0.1


    result = ivsweep(cell; voltages, store_solutions=true, kwargs...)
    tsol = voltages_solutions(result)
    currs = currents(result, ia)
    volts = result.voltages

    vis = GridVisualizer(Plotter = Plotter, layout = (1, 1))

    scalarplot!(
        vis[1, 1],
        volts,
        currs * ufac&quot;cm^2/mA&quot;,
        color = :red,
        markershape = :utriangle,
        markersize = 7,
        markevery = 10,
        label = &quot;PNP&quot;,
        legend = :lt,
        xlabel = &quot;Δϕ/V&quot;,
        ylabel = &quot;I/(mA/cm^2)&quot;,
    )
    ##scalarplot!(vis[2,1], sigmas, energies, color=&quot;black&quot;,clear=true,xlabel=&quot;σ/(μC/cm^s)&quot;,ylabel=&quot;ΔE/eV&quot;)
    ##scalarplot!(vis[2,1], ϕs, rs, xlimits=(-1.5,-0.6), yscale=:log, xlabel=&quot;Δϕ/V&quot;, ylabel=&quot;c(CO2)/M&quot;)
    for curr in currs
        println(curr)
    end
    return reveal(vis)
end

end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Main.Example111_SurfaceKinetics</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Example110_Fe23Cell/">« Fe redox half cell</a><a class="docs-footer-nextpage" href="../Example120_ORRCell/">ORR Half cell »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 24 July 2023 21:59">Monday 24 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
